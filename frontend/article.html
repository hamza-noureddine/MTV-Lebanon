<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Article</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <a href="index.html" class="back">← Back to Homepage</a>

  <div id="article" class="article-full"></div>

  <script>

    const API_BASE = "https://mtv-lebanon.onrender.com";

    // Load all saved articles (newest first)
    async function loadArticles() {
        const res = await fetch(`${API_BASE}/articles`);
        const data = await res.json();

        const container = document.getElementById("articles");
        container.innerHTML = "";

        data.forEach(a => {
            container.innerHTML += `
                <div class="article">
                    <h2>${a.title}</h2>
                    <p>${a.date} • ${a.time} • ${a.category}</p>

                    ${
                      a.is_video
                        ? `<video controls poster="${a.video_poster}" src="${a.video_url}"></video>`
                        : `<img src="${a.image}" />`
                    }

                    <p>${a.text.substring(0, 200)}...</p>
                    <a href="${a.url}" target="_blank">Read Full Article</a>
                </div>
            `;
        });
    }

    // Fetch new articles only if they don't exist
    async function fetchData() {
        document.getElementById("status").innerHTML = "Checking for new articles...";

        const res = await fetch(`${API_BASE}/scrape`, { method: "POST" });
        const data = await res.json();

        document.getElementById("status").innerHTML = data.message;

        // Only reload UI if new articles were added
        if (!data.message.includes("No new articles")) {
            loadArticles();
        }
    }

    // Auto-load on first visit
    loadArticles();
</script>

  

</body>
</html>
